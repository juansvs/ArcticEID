<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Model description</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="model_description_files/libs/clipboard/clipboard.min.js"></script>
<script src="model_description_files/libs/quarto-html/quarto.js"></script>
<script src="model_description_files/libs/quarto-html/popper.min.js"></script>
<script src="model_description_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="model_description_files/libs/quarto-html/anchor.min.js"></script>
<link href="model_description_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="model_description_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="model_description_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="model_description_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="model_description_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model description</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>To get a better understanding of how bacterial diseases are spreading across populations of ungulates in the Canadian Arctic, and how they may be impacting these populations, we built a series of epidemiological models. These models represent the demographics and disease transmission processes for two bacteria of interest: <em>Erysipelothrix rhusiopatiae</em> (Er) and <em>Brucella suis</em> (Bs). Er has caused mass mortality events, which have been documented since 2011. Bs in turn causes abortions, reducing mean fecundity in the population. Given low population growth rates in musk oxen in particular, reductions in fecundity could have significant detrimental impact on these populations.</p>
<section id="deterministic-model" class="level2">
<h2 class="anchored" data-anchor-id="deterministic-model">Deterministic model</h2>
<p>First, we build deterministic models that use a system of ordinary differential equations (ODE). These models follow a SIR(D) structure (D for carcasses on the landscape). The models include demographic—fecundity, natural mortality—and epidemiological processes—acquisition, disease mortality. The diagram below shows a schematic representation of this model applied to <em>Er</em> in musk oxen. In this model, susceptible individuals (S) become infected with the bacterium (I) following contact with contaminated carcasses (D), or with infected individuals. Once infected, individuals can either become resistant (R), or develop a pathology and die.</p>
<div id="sirdiagram">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/SIR_diagram.png" class="img-fluid figure-img" width="400"></p>
<figcaption class="figure-caption">Representation of the basic SIRD model for epidemiology of <em>Erysipelothrix rhusiopatiae</em> in musk oxen</figcaption>
</figure>
</div>
</div>
<p>The model is represented by the following ODE system:</p>
<p><span class="math display">\[
\begin{align}
\frac{dS}{dt}&amp;=\phi(S+I+R)-\mu_N S-\beta S(D+I)+\lambda R\\
\frac{dI}{dt}&amp;=-\mu_N I +\beta S(D+I)-\theta\mu_I I -(1-\theta)\rho I\\
\frac{dR}{dt}&amp;=-\mu_N R+(1-\theta)\rho I-\lambda R\\
\frac{dD}{dt}&amp;=\theta\mu_I I-\delta D
\end{align}
\]</span></p>
<p>Parameters are as follows:</p>
<table class="table">
<caption>Description of parameters in the Er-musk ox compartmental epidemiological model</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 63%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Value</th>
<th>Units</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\phi\)</span></td>
<td><em>Per capita</em> fecundity rate. Assumed at first to be equal regardless of disease</td>
<td>0.5</td>
<td>1/year</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu_N\)</span></td>
<td><em>Per capita</em> natural mortality rate</td>
<td>1/12</td>
<td>1/year</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta\)</span></td>
<td>Bacteria transmission rate. Calculated as a search efficiency rate that scales the number of encounters</td>
<td>5</td>
<td>km^2/individual year</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\theta\)</span></td>
<td>Proportion of infected individuals that develop a pathology and die</td>
<td>0.8</td>
<td>Unitless</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mu_I\)</span></td>
<td><em>Per capita</em> disease-induced mortality rate</td>
<td>365/5</td>
<td>1/year</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\rho\)</span></td>
<td><em>Per capita</em> rate of recovery from infection. This is the rate at which infected individuals become immune</td>
<td>365/15</td>
<td>1/year</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\lambda\)</span></td>
<td><em>Per capita</em> rate of loss of immunity</td>
<td>1</td>
<td>1/year</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\delta\)</span></td>
<td><em>Per capita</em> rate of disappearance of carcasses (or environmental bacteria sources)</td>
<td>1/2</td>
<td>1/year</td>
</tr>
</tbody>
</table>
<div class="cell" data-fig.asp="0.75">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="model_description_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Epidemiological model of E.rhus. in musk oxen</figcaption>
</figure>
</div>
</div>
</div>
<section id="maternal-immunity" class="level3">
<h3 class="anchored" data-anchor-id="maternal-immunity">Maternal immunity</h3>
<p>There is some evidence that antibodies can be transferred to newborns. We can include this in the model by having the resistant compartment increase through births, rather than resistant individuals contributing to .</p>
<p><img src="images/SIR_diagram_matimmun.png" class="img-fluid" width="350"></p>
<p><span class="math display">\[\begin{align}
\frac{dS}{dt}&amp;=\phi(S+I)-\mu_N S-\beta S(D+I)+\lambda R\\
\frac{dI}{dt}&amp;=-\mu_N I +\beta S(D+I)-\theta\mu_I I -(1-\theta)\rho I\\
\frac{dR}{dt}&amp;=\phi R-\mu_N R+(1-\theta)\rho I-\lambda R\\
\frac{dD}{dt}&amp;=\theta\mu_I I-\delta D
\end{align}\]</span></p>
<div class="cell" data-fig.asp="0.75">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="model_description_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Epidemiological model of E.rhus. in musk oxen including maternal transference of immunity</figcaption>
</figure>
</div>
</div>
</div>
<p>Including maternal immunity does not have a large impact on the overall predictions from the model. You still see a large reduction in population size, and a slow recovery followed by a new crash as the density of susceptible individuals increases again.</p>
</section>
<section id="stage-structure" class="level3">
<h3 class="anchored" data-anchor-id="stage-structure">Stage structure</h3>
<p>To better capture the long-term effects of disease on the population, we can further divide the compartments by stages, so that juveniles cannot reproduce, but can become infected and die. This model also allows to include maternally transferred immunity. The diagram below represents this model. The equations now include a development term <span class="math inline">\(\gamma\)</span> that represents the rate of transition from juvenile to adult. Assuming first reproduction at 3 years of age, the rate of transition is given by <span class="math inline">\(\gamma=1/(1+\mu_J)^3\)</span>, where <span class="math inline">\(\mu_J\)</span> is the yearly mortality rate of juveniles (30%?).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/SIR_diagram_stages_matimmun.png" class="img-fluid figure-img" width="350"></p>
<figcaption class="figure-caption">Epidemiological model with stage structure and maternal immunity transference</figcaption>
</figure>
</div>
<p>The new system of ODE is the following:</p>
<p><span class="math display">\[\begin{align}
\frac{dS_J}{dt}&amp;=\phi(S_A+I_A)-\gamma S_J-\mu_{J} S_J-\beta S_J(D+I_J+I_A)+\lambda R_J\\
\frac{dI_J}{dt}&amp;=-\mu_{J} I_J-\gamma I_J +\beta S_J(D+I_J+I_A)-\theta\mu_I I_J -(1-\theta)\rho I_J\\
\frac{dR_J}{dt}&amp;=\phi R_A-\mu_{J} R_J+(1-\theta)\rho I_J-\lambda R_J\\
\frac{dS_A}{dt}&amp;=\gamma S_J-\mu_{N} S_A-\beta S_A(D+I_J+I_A)+\lambda R_A\\
\frac{dI_A}{dt}&amp;=\gamma I_J-\mu_{N} I_A+\beta S_A(D+I_J+I_A)-\theta \mu_I I_A-(1-\theta)\rho I_A\\
\frac{dR_A}{dt}&amp;=\gamma R_J-\mu_{N} R_A+(1-\theta)\rho I_A-\lambda R_A\\
\frac{dD}{dt}&amp;=\theta\mu_I (I_A+I_J)-\delta D\\
\end{align}\]</span></p>
<div class="cell" data-fig.asp="0.75">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="model_description_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Stage-structured epidemiological model of E.rhus. in musk oxen</figcaption>
</figure>
</div>
</div>
</div>
<p>Including stage structure delays the recovery of the population. This makes sense given that we are including juvenile mortality, which reduces the growth rate of the population.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>